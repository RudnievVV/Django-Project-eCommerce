{% extends 'ecommerce/base.html' %}
{% load static %}
{% load custom_tags %}
{% block content %}
  <!-- offer block Start  -->
  <div id="offer">
    <div class="container">
      <div class="offer">
        <p>30 New Mega Sales. Up to 80% Off. Starting Everyday at 9 AM.</p>
      </div>
    </div>
  </div>
  <!-- offer block end  -->

<!-- breadcrumb and page title block start  -->
<div id="bread-crumb">
  <div class="container">
    <div class="row">
        {% if title %}
          <div class="col-md-3">
            <div class="page-title">
              <h4>{{ title }}</h4>
            </div>
          </div>
        {% else %}
          <div class="col-md-3">
            <div class="page-title">
              <h4>Python eCommerce</h4>
            </div>
          </div>
        {% endif %}
        {% breadcrumbs request.path %}
    </div>
  </div>
</div>
<!-- breadcrumb and page title block end  -->
  
  <div id="product-category">
    <div class="container">
      <div class="row">
        <div class="col-md-3 col-sm-4"> 
          <!-- left block Start  -->
          <div id="left">
            <div class="sidebar-block">
              <div class="sidebar-widget Category-block">
                <div class="sidebar-title">
                  <h4> Categories</h4>
                </div>
                <ul class="title-toggle">
                  {% for category in categories %}
                    {% if category.category_products_count %}
                      <li><a href="{{ category.get_absolute_url }}">{{ category.title }}</a> ({{ category.category_products_count }})</li>
                    {% endif %}
                  {% empty %}
                    <li>No categories</li>
                  {% endfor %}
                </ul>
              </div>
              <div class="sidebar-widget Price-range">
                <div class="sidebar-title">
                  <label for="amount">Price range:</label>
                  <input type="text" id="amount" readonly style="border:0; color:#4d90fe; font-weight:bold;">
                  <div id="slider-range"></div>
                </div>
              </div>
              <div class="sidebar-widget Shop-by-block">
                <div class="sidebar-title">
                  <h4>Shop by</h4>
                </div>
                <ul class="title-toggle">
                  <li class="category">
                    <h5><a href="grid-view.html">Category</a></h5>
                    <ul>
                      <li><a href="grid-view.html">Bags 2 </a></li>
                      <li><a href="grid-view.html">Clothing x2 2 (0)</a></li>
                      <li><a href="grid-view.html">Lingerie 2 (0) </a></li>
                    </ul>
                  </li>
                  <li class="color">
                    <h5><a href="grid-view.html">Color</a></h5>
                    <ul>
                      <li><a href="grid-view.html">red (2) </a></li>
                      <li><a href="grid-view.html">blue (5)</a></li>
                      <li><a href="grid-view.html">yelow (0) </a></li>
                      <li><a href="grid-vier.html">black (4)</a></li>
                    </ul>
                  </li>
                  <li class="manufacture">
                    <h5><a href="grid-view.html">Manufacture</a></h5>
                    <ul>
                      <li><a href="grid-view.html">Bags 2 </a></li>
                      <li><a href="grid-view.html">Clothing x2 2 (0)</a></li>
                      <li><a href="grid-view.html">Lingerie 2 (0) </a></li>
                    </ul>
                  </li>
                </ul>
              </div>
              <div class="sidebar-widget banner-block">
                <div class="left-banner"> <a href="#"><img src="{{ MEDIA_URL }}images/product/left-banner.jpg" alt="#"></a> </div>
              </div>
              <div class="sidebar-widget Best-Products-block">
                <div class="sidebar-title">
                  <h4> Best Products</h4>
                </div>
                <ul class="title-toggle">
                  <li>
                    <div class="product-block ">
                      <div class="item col-md-4 col-sm-4 col-xs-4">
                        <div class="image"> <a href="product-detail-view.html"><img class="img-responsive" title="T-shirt" alt="T-shirt" src="{{ MEDIA_URL }}images/product/3prod281x366.jpg"></a> </div>
                      </div>
                      <div class="item col-md-8 col-sm-8 col-xs-8">
                        <div class="product-details">
                          <div class="product-name">
                            <h5><a href="product-detail-view.html">Black African Print Pencil Skirt </a></h5>
                          </div>
                          <div class="review"></div>
                          <div class="price"> <span class="price-new">$14.99</span> </div>
                          <div class="addto-cart"><a href="#">Add to Cart</a></div>
                        </div>
                      </div>
                    </div>
                  </li>
                  <li>
                    <div class="product-block ">
                      <div class="item col-md-4 col-sm-4 col-xs-4">
                        <div class="image"> <a href="product-detail-view.html"><img class="img-responsive" title="T-shirt" alt="T-shirt" src="{{ MEDIA_URL }}images/product/4prod281x366.jpg"></a> </div>
                      </div>
                      <div class="item col-md-8 col-sm-8 col-xs-8">
                        <div class="product-details">
                          <div class="product-name">
                            <h5><a href="product-detail-view.html">Black African Print Pencil Skirt </a></h5>
                          </div>
                          <div class="review"></div>
                          <div class="price"> <span class="price-new">$14.99</span> </div>
                          <div class="addto-cart"><a href="#">Add to Cart</a></div>
                        </div>
                      </div>
                    </div>
                  </li>
                  <li>
                    <div class="product-block ">
                      <div class="item col-md-4 col-sm-4 col-xs-4">
                        <div class="image"> <a href="product-detail-view.html"><img class="img-responsive" title="T-shirt" alt="T-shirt" src="{{ MEDIA_URL }}images/product/5prod281x366.jpg"></a> </div>
                      </div>
                      <div class="item col-md-8 col-sm-8 col-xs-8">
                        <div class="product-details">
                          <div class="product-name">
                            <h5><a href="product-detail-view.html">Black African Print Pencil Skirt </a></h5>
                          </div>
                          <div class="review"></div>
                          <div class="price"> <span class="price-new">$14.99</span> </div>
                          <div class="addto-cart"><a href="#">Add to Cart</a></div>
                        </div>
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <!-- left block end  --> 
        </div>
        <div class="col-md-9 col-sm-8"> 
          <!-- right block Start  -->
          <div id="right">
            <div class="category-banner"> <a href="#"><img src="{{ category.banner.url }}" alt="#"></a> </div>
            <div class="row">
              <div class="col-md-6">
                <div class="view">
                  <div class="grid active"><a href="{% url 'product-list-by-category-view' category_slug=category.slug category_view='grid' %}">
                    <div class="grid-icon "></div>
                    </a> </div>
                  <div class="list"><a href="{% url 'product-list-by-category-view' category_slug=category.slug category_view='list' %}">
                    <div class="list-icon "></div>
                    </a> </div>
                </div>
                <div class="category-products-count">
                  {% if products_count > 1 %}
                    There is <strong>{{ products_count }}</strong> products in Category!
                  {% else %}
                    There is only <strong>one</strong> product in Category!
                  {% endif %}
                </div>
              </div>
              <div class="col-md-6">
                <div class="shoring pull-right">
                  <div class="short-by">
                    <p>Sort By</p>
                    <div class="select-item">
                      <form method="POST">
                        {% csrf_token %}
                        <select name="pagination-sortby-select-dropdown" onchange="this.form.submit()">
                          <option value="title" {% if pagination_sort_by == "title" %} selected="selected" {% endif %}>Name (A to Z)</option>
                          <option value="-title" {% if pagination_sort_by == "-title" %} selected="selected" {% endif %}>Name (Z to A)</option>
                          <option value="price" {% if pagination_sort_by == "price" %} selected="selected" {% endif %}>Price (low &gt; high)</option>
                          <option value="-price" {% if pagination_sort_by == "-price" %} selected="selected" {% endif %}>Price (high &gt; low)</option>
                          <option value="rating" {% if pagination_sort_by == "rating" %} selected="selected" {% endif %}>Rating (highest)</option>
                          <option value="-rating" {% if pagination_sort_by == "-rating" %} selected="selected" {% endif %}>Rating (lowest)</option>
                        </select>
                        <span class="fa fa-angle-down"></span></div>
                  </div>
                  <div class="show-item">
                    <p>Show</p>
                    <div class="select-item">
                        <select name="pagination-showgrid-select-dropdown" onchange="this.form.submit()">
                          <option value="12" {% if pagination_show_grid == 12 %} selected="selected" {% endif %}>12</option>
                          <option value="18" {% if pagination_show_grid == 18 %} selected="selected" {% endif %}>18</option>
                          <option value="24" {% if pagination_show_gtrid == 24 %} selected="selected" {% endif %}>24</option>
                        </select>
                        <span class="fa fa-angle-down"></span></div>
                      </form>
                  </div>
                </div>
              </div>
            </div>
            <div class="product-grid-view">
              <ul>
                {% for product in products %}
                  <li>
                    <div class="item col-md-4 col-sm-6 col-xs-6">
                      <div class="product-block ">
                        <div class="image"> <a href="{{ product.get_absolute_url }}"><img class="img-responsive" title="{{ product.title }}" alt="{{ product.title }}" src="{{ product.image.url }}"></a> </div>
                        <div class="product-details">
                          <div class="product-name">
                            <h4><a href="{{ product.get_absolute_url }}">{{ product.title }}</a></h4>
                          </div>
                          <div class="price"> <span class="price-old"></span> <span class="price-new">{{ product.price }}</span> </div>
                          <div class="product-hov">
                            <ul>
                              <li class="wish"><a href="#"></a></li>
                              <li class="addtocart">
                                <form action="{% url 'cart-add' product.id %}" method="POST">
                                  {% csrf_token %}
                                  <div class="do_not_display">{{ cart_product_form }}</div>
                                  <input type="submit" value="Add to cart" class="addtocart">
                                </form>
                              </li>
                              <li class="compare"><a href="#"></a></li>
                            </ul>
                            <div class="review"> <span class="rate"> <i class="fa fa-star rated"></i> <i class="fa fa-star rated"></i> <i class="fa fa-star rated"></i> <i class="fa fa-star rated"></i> <i class="fa fa-star"></i> </span> </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </li>
                {% endfor %}
              </ul>
            </div>
          </div>
          <div class="row">
            <div class="pagination-bar">
              <ul>
                {% if products.paginator.num_pages > 1 %}

                  {% if products.has_previous %}
                      <li><a href="?page=1">First</a></li>
                      <li><a href="?page={{ products.previous_page_number }}"><i class="fa fa-angle-left"></i></a></li>
                  {% endif%}

                  {% for num in products.paginator.page_range %}
                      {% if products.number == num %}
                          <li class="active"><a href="?page={{ num }}">{{ num }}</a></li>
                      {% elif num > products.number|add:'-3' and num < products.number|add:'3' %}
                          <li><a href="?page={{ num }}">{{ num }}</a></li>
                      {% endif %}
                  {% endfor %}

                  {% if products.has_next %}
                      <li><a href="?page={{ products.next_page_number }}"><i class="fa fa-angle-right"></i></a></li>
                      <li><a href="?page={{ products.paginator.num_pages }}">Last</a></li>
                  {% endif%}

                {% endif %}
            </div>
          </div>
          <!-- right block end  --> 
        </div>
      </div>
    </div>
  </div>
</div>
<!-- jQuery (price shorting) --> 
<script>
	$(function() {
    	$( "#slider-range" ).slider({
      	range: true,
      	min: {{ min_product_price }},
      	max: {{ max_product_price }},
      	values: [ {{ min_product_price }}, {{ max_product_price }} ],
      	slide: function( event, ui ) {
        $( "#amount" ).val( "$" + ui.values[ 0 ] + " - $" + ui.values[ 1 ] );
      	}
    	});
    	$( "#amount" ).val( "$" + $( "#slider-range" ).slider( "values", 0 ) +
      	" - $" + $( "#slider-range" ).slider( "values", 1 ) );
  		});
</script> 
{% endblock content %}